{% extends "layout.html" %} {% block content %}
<h1>UPLOAD</h1>
<div id="uploadPage"></div>
<script
  type="text/javascript"
  src="{{ url_for('static', filename='js/Layout.js') }}"
></script>
<script type="text/javascript" src="../dist/bundle.js"></script>

<head>
  <script type="text/javascript" src="../dist/bundle.js"></script>
  <link rel="stylesheet" href="/dist/Upload.css" />
</head>

<body>
  <form action="upload.php" method="post" enctype="multipart/form-data">
    Select file to upload:
    <input type="file" name="fileToUpload" id="fileToUpload" />
    <input type="submit" value="Upload Image" name="submit" />
  </form>

  <button type="submit" onclick="upload()">Upload a file</button>
  <div class="uploadtext" id="uploadedFile"></div>
  <br />
  <div class="dropzone" id="dropzone">Drag Files here</div>
</body>

<script>
  var files;

  function upload() {
    var formData = new FormData(),
      xhr = new XMLHttpRequest();
    xhr.onload = function() {
      var data = this.responseText;
    };
    xhr.open("post", "/upload_api/");
    xhr.send(FormData);
  }

  (function() {
    var dropzone = document.getElementById("dropzone");

    //create a upload function, checks accept only one file and sends it to the backend "/upload/"
    var loadFile = function(file) {
      if (file.length == 0) {
        //upload file
      } else if (file.length > 1) {
        alert("Upload only one file");
      } else {
        document.getElementById("uploadedFile").innerHTML = file[0].name;
      }
    };

    // This is for the animation of the drag n drop

    dropzone.ondrop = function(event) {
      event.preventDefault();
      this.className = "dropzone";
      loadFile(event.dataTransfer.files);
      files = event.dataTransfer.files;
    };

    dropzone.ondragover = function() {
      this.className = "dropzone dragover";
      return false;
    };

    dropzone.ondragleave = function() {
      this.className = "dropzone";
      return false;
    };
  })();
</script>
{% endblock content %}
